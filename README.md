NET_RAID_FS 
>Final Project for Freeuni / Macs / OS


Vache Katsadze - vkats15@freeuni.edu.ge


>შესავალი

network raid filesystem არის raid 1 ალგორითმებზე დაშენებული ქსელური ფაილური სისტემა
ინფორმაციის დასაცავად გამოიყენება stable storage მექანიზმი (md5 ჰეშის გამოყენებით), ერთჯერადად
დაკარგული სერვერის ჩანაცვლება ხდება hotswap სერვერით, რომლის დროსაც ხდება გადარჩენილი
სერვერიდან დატას დუბლირება hotswap სერვერზე, პერფორმანსის გაუმჯობესებისთვის იმპლემენტირებულია
ქეშირების / epoll მექანიზმები  



>პროექტის სტრუქტურა

```
.
|-- server
|   |-- MakeFile
|   |-- net_raid_server.c
|
|-- Makefile
|-- net_raid_client.c
|-- parser.c
|-- parser.h
|-- README.md
|-- DOC
|-- utils.h
.

``` 

პროექტის ფაილების სტრუქტურა არის შემდეგნაირი :
განცალკევებულია სერვერის და კლიენტის გამშვები კოდები და შესამაბისად აქვთ ცალ - ცალკე makefile ები, 
კლიენტის მხარეს არის დამატებით parser.c /  parser.h ფაილები, რომლებიც პროგრამის გაშვებისას გამოიყენება
კონფიგურაციის ფაილის დასაპარსად, კლიენტის მხარეს ასევე ვნახავთ utils.h ფაილს, რომელშის არის ყველა 
ის სტრუქტურა აღწერილი, რომელსაც პროგრამა იყენებს, utils.h არის საერთო client / server ისთვის რადგან
ორივემ უნდა იცოდეს ერთი რას გზავნის და მეორე რას იღებს.



>გამოყენება
პროგრამის გასაშვებად საჭიროა ვალიდური config file ის არსებობა, config file არის ასეთი სახის:


```
errorlog = /path/to/error.log
cache_size = 1024M
cache_replacement = rlu
timeout = 10

diskname = STORAGE1
mountpoint = /path/to/mountpoint1
raid = 1
servers = 127.0.0.1:10001, 127.0.0.1:10002
hotswap = 127.0.0.1:11111 

diskname = STORAGE2
mountpoint = /path/to/mountpoint2
raid = 5
servers = 127.0.0.1:10011, 127.0.0.1:10012, 127.0.0.1:10013
hotswap = 127.0.0.1:22222

```

სადაც 
1. errorlog არის იმ ფაილის path სადაც გინდათ რომ დაილოგოს პროგრამის სხვადასხვა აქტიურობები
2. cache_size არის ქეშის ზომა, შეგიძლიათ გადასცეთ B/K/M/G
3. cache_replacement არის ქეშიდან ენთრის გამოძევების ალგორითმი, ვალიდურია მხოლოდ rlu ზე
4. timeout არის დრო (წამებში), რა დროც ელოდება პროგრამა გათიშულ სერვერს, ამ დროის გასვლის შემდეგ
	სერვერი ცხადდება დაკარგულად და ილოგება შესაბამისი ინფორმაცია, ამ დროში სერვერის დაბრუნებისას კი
	პროგრამა აგრძელებს ჩვეულ მუშაობას.

ამ ზოგადი კონფიგების შემდგომ მოდის დისკების კონფიგი, რომელიც შეიძლება იყოს ნებისმიერი რაოდენობის
1. diskname, დისკის სახელი, საჭიროა მხოლოდ ლოგირებისთვის
2. mountpoint, ამ დისკის მთავარი მაუნთ დირექტორია, რომელშიც უნდა განხორციელდეს კლიენტის მხრიდან
	წერა - კითხვა
3. raid, რაიდ ალგორითმის ნომერი, 1 ან 5, თუმცა ეს კონკრეტული იმპლემენტაცია მოიცავს მხოლოდ raid 1 ს
4. servers, სერვერების ჩამონათვალი, რომლებიც კლიენტის გაშვებამდე უნდა იყვნენ დარეგისტრირებულები, 
	რაიდ 1 ის შემთხვევაში გვაქვს მხოლოდ 2 სერვერი, რაიდ 5 ის შემთხვევაში 3 +, თუმცა ამ კონკრეტულ 
	იმპლემენტაციაში ასეთი დისკიც რაიდ 1 ად ითვლება და იყენებს მხოლოდ პირველ ორ სერვერს
5. hotswap, ჰოტსვაპ სერვერი, დაკარგული სერვერის ჩასანაცვლებლად. თუ რომელიმე სერვერი დაიკარგა, ჯერ 
	timeout დრო დალოდება მოხდება და ჩანაცვლდება ჰოტსვაპ სერვერით, გადარჩენილი სერვერიდან კი 
	გადაიწერება მთლიანი დატა, თუ ჰოტსვაპის შემდგომ კიდე მოხდა სერვერის გათიშვა, პროგრამა გააგრძელებს
	მუშაობას ერთი სერვერით.

კონფიგურაციის ფაილის შექმნის შემდგომ უნდა მოხდეს libssl ის დაყენება ჰეშირების მექანიზმების ასამუშავებლად
command - $ sudo apt-get install libpcap-dev libssl-dev


ამ package ს დაინსტალირების შემდეგ უკვე შესაძლებელია პროგრამის გაშვება, პირველ რიგში ეშვება სერვერი:

1. /NET_RAID_FS/server დირექტორიაში გახსნილი terminal დან პირველ რიგში გაუშვით make ბრძანება კოდის 
	დასაკომპილირებლად
2. თვითონ სერვერის გავება ხდება შემდეგი command ით, ./net_raid_server [ip] [port] [storagedir]
	მაგალითისთვის - ./net_raid_server 127.0.0.1 10001 /home/kobi/Desktop/storagedir1
3. თავდაპირველად უნდა დარეგისტრირდეს და თავიანთ ქონექშენს ელოდებოდეს, ყველა ის სერვერი, რომელიც 
	კონფიგურაციის ფაილში იყო მითითებული

ყველა სერვერის დარეგისტრირების შემდეგ ეშვება კლიენტი

1. /NET_RAID_FS დირექტორიაში გახსნილი terminal დან პირველ რიგში გაუშვით make ბრძანება კოდის
	დასაკომპილირებლად
2. თვითონ პროგრამის გასაშვებად გამოიყენეთ შემდეგი command ./net_raid_client [config file]
	მაგალითისთვის ./net_raid_client /home/kobi/Desktop/config_file.txt

პროგრამის გაშვების შემდგომ კონფიგ ფაილში მითითებული mountpoint - ი / ები დამაუნთდება და უკვე შესაძლებელი 
იქნება ამ მაუნთფოინთში მუშაობა, რეალურად დატა იქნება შენახული სერვერის მხარეს, დარეგისტრირებისას მითითებულ
storagedir ებში